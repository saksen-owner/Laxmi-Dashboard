<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laxmi's AI-Powered Forest Study Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
            overflow-y: auto;
            min-height: 100vh;
            position: relative;
            transition: all 0.5s ease;
        }

        body.mood-tired {
            filter: brightness(0.7) saturate(0.8);
        }

        body.mood-motivated {
            filter: brightness(1.2) saturate(1.3);
        }

        /* Splash Screen */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 1s ease-in-out;
        }

        .splash-screen.fade-out {
            opacity: 0;
        }

        .splash-text {
            font-family: 'Sacramento', cursive;
            font-size: 3rem;
            color: white;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Background Slideshow */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .background-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }

        .background-slide.active {
            opacity: 1;
        }

        /* Main Content */
        .main-container {
            position: relative;
            width: 100%;
            min-height: 100vh;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            overflow-y: auto;
        }

        .dashboard-header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }

        .dashboard-title {
            font-family: 'Sacramento', cursive;
            font-size: 3.5rem;
            color: white;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .dashboard-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 300;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .card-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .card-title {
            font-size: 1.4rem;
            color: white;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .time-section {
            text-align: center;
            margin-bottom: 0;
        }

        .live-clock {
            font-size: 3rem;
            font-weight: 700;
            color: white;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-family: 'Courier New', monospace;
        }

        .date-display {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 400;
        }

        .countdown-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 0;
        }

        .countdown-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .countdown-title {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .countdown-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #4ade80;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .quote-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .quote-text {
            font-style: italic;
            color: white;
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .quote-author {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
            font-weight: 500;
        }

        .timer-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 0;
        }

        .timer-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .timer-title {
            font-size: 1.3rem;
            color: white;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .timer-display {
            font-size: 2.5rem;
            font-weight: 700;
            color: #fbbf24;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .timer-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            min-width: 100px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .countdown-input {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .time-input {
            width: 70px;
            padding: 12px;
            border: none;
            border-radius: 12px;
            text-align: center;
            font-family: 'Poppins', sans-serif;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .time-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .time-label {
            color: white;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
        }

        /* AI Features */
        .ai-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }

        .ai-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            min-height: 250px;
            display: flex;
            flex-direction: column;
        }

        .ai-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .ai-title {
            font-size: 1.4rem;
            color: white;
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ai-content {
            color: white;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
            flex: 1;
        }

        .study-plan {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #4ade80;
        }

        .plan-item {
            color: white;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
        }

        .plan-item:last-child {
            border-bottom: none;
        }

        .focus-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            color: white;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 15px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4ade80;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            opacity: 0.8;
            font-weight: 500;
        }

        .mood-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }

        .mood-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mood-happy {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .mood-focused {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .mood-tired {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }

        .mood-stressed {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .mood-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* AI Chat Companion */
        .ai-companion {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .chat-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4ade80, #22c55e);
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .chat-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(0,0,0,0.4);
        }

        .chat-window {
            position: fixed;
            bottom: 120px;
            right: 30px;
            width: 350px;
            height: 450px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
        }

        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: #333;
            font-weight: 600;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 12px;
            padding: 12px 16px;
            border-radius: 18px;
            max-width: 85%;
            font-size: 0.9rem;
        }

        .message.ai {
            background: #f0f0f0;
            color: #333;
            margin-right: auto;
        }

        .message.user {
            background: #4ade80;
            color: white;
            margin-left: auto;
        }

        .chat-input {
            display: flex;
            gap: 12px;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
        }

        .chat-input button {
            padding: 12px 20px;
            background: #4ade80;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        /* Audio Controls */
        .audio-controls {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1000;
        }

        .audio-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            color: white;
            font-size: 1.4rem;
            transition: all 0.3s ease;
        }

        .audio-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
            
            .ai-features {
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
                gap: 15px;
                min-height: auto;
                height: auto;
            }

            .dashboard-header {
                padding: 20px 15px;
                margin-bottom: 15px;
            }

            .dashboard-title {
                font-size: 2.2rem;
                margin-bottom: 10px;
            }

            .dashboard-subtitle {
                font-size: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .ai-features {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .dashboard-card {
                padding: 20px 15px;
                min-height: auto;
            }

            .card-header {
                margin-bottom: 15px;
            }

            .card-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .card-title {
                font-size: 1.2rem;
            }

            .live-clock {
                font-size: 2.2rem;
            }

            .date-display {
                font-size: 1rem;
            }

            .countdown-value {
                font-size: 2rem;
            }

            .countdown-title {
                font-size: 0.9rem;
            }

            .timer-display {
                font-size: 2rem;
            }

            .timer-title {
                font-size: 1.1rem;
            }

            .quote-text {
                font-size: 1rem;
            }

            .quote-author {
                font-size: 0.9rem;
            }

            .focus-stats {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .stat-item {
                padding: 12px;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }

            .mood-buttons {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .mood-btn {
                padding: 10px 12px;
                font-size: 0.85rem;
            }

            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
                min-width: 80px;
            }

            .time-input {
                width: 60px;
                padding: 10px;
                font-size: 0.9rem;
            }

            .countdown-input {
                gap: 10px;
            }

            .chat-window {
                width: calc(100vw - 30px);
                height: 350px;
                right: 15px;
                bottom: 90px;
                left: 15px;
            }

            .ai-companion {
                bottom: 15px;
                right: 15px;
            }

            .chat-btn {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .audio-controls {
                top: 15px;
                right: 15px;
            }

            .audio-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .splash-text {
                font-size: 1.8rem;
                padding: 0 20px;
            }
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 8px;
                gap: 12px;
            }

            .dashboard-header {
                padding: 15px 10px;
                margin-bottom: 12px;
            }

            .dashboard-title {
                font-size: 1.8rem;
                margin-bottom: 8px;
            }

            .dashboard-subtitle {
                font-size: 0.9rem;
            }

            .dashboard-card {
                padding: 15px 10px;
            }

            .card-header {
                margin-bottom: 12px;
            }

            .card-icon {
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }

            .card-title {
                font-size: 1.1rem;
            }

            .live-clock {
                font-size: 1.8rem;
            }

            .date-display {
                font-size: 0.9rem;
            }

            .countdown-value {
                font-size: 1.6rem;
            }

            .countdown-title {
                font-size: 0.8rem;
            }

            .timer-display {
                font-size: 1.6rem;
            }

            .timer-title {
                font-size: 1rem;
            }

            .quote-text {
                font-size: 0.9rem;
                line-height: 1.5;
            }

            .quote-author {
                font-size: 0.8rem;
            }

            .ai-card {
                padding: 15px 10px;
            }

            .ai-title {
                font-size: 1.2rem;
                margin-bottom: 15px;
            }

            .ai-content {
                font-size: 0.9rem;
            }

            .stat-value {
                font-size: 1.3rem;
            }

            .stat-label {
                font-size: 0.75rem;
            }

            .btn {
                padding: 8px 16px;
                font-size: 0.85rem;
                min-width: 70px;
            }

            .time-input {
                width: 50px;
                padding: 8px;
                font-size: 0.85rem;
            }

            .time-label {
                font-size: 0.8rem;
            }

            .mood-btn {
                padding: 8px 10px;
                font-size: 0.8rem;
            }

            .chat-window {
                width: calc(100vw - 20px);
                height: 300px;
                right: 10px;
                bottom: 80px;
                left: 10px;
                padding: 15px;
            }

            .chat-header {
                margin-bottom: 15px;
                font-size: 0.9rem;
            }

            .message {
                padding: 10px 12px;
                font-size: 0.85rem;
            }

            .chat-input input {
                padding: 10px 12px;
                font-size: 0.85rem;
            }

            .chat-input button {
                padding: 10px 16px;
                font-size: 0.85rem;
            }

            .ai-companion {
                bottom: 10px;
                right: 10px;
            }

            .chat-btn {
                width: 55px;
                height: 55px;
                font-size: 1.4rem;
            }

            .audio-controls {
                top: 10px;
                right: 10px;
            }

            .audio-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }

            .splash-text {
                font-size: 1.5rem;
                padding: 0 15px;
            }
        }

        @media (max-width: 360px) {
            .dashboard-title {
                font-size: 1.6rem;
            }

            .live-clock {
                font-size: 1.6rem;
            }

            .countdown-value {
                font-size: 1.4rem;
            }

            .timer-display {
                font-size: 1.4rem;
            }

            .btn {
                padding: 6px 12px;
                font-size: 0.8rem;
                min-width: 60px;
            }

            .time-input {
                width: 45px;
                padding: 6px;
                font-size: 0.8rem;
            }

            .splash-text {
                font-size: 1.3rem;
            }
        }

        /* Fix for iOS Safari */
        @supports (-webkit-touch-callout: none) {
            .main-container {
                min-height: -webkit-fill-available;
            }
            
            body {
                min-height: -webkit-fill-available;
            }
        }

        /* Fix for Android Chrome */
        @media screen and (max-height: 600px) {
            .main-container {
                min-height: auto;
                padding: 5px;
            }
            
            .dashboard-card {
                padding: 10px;
            }
            
            .ai-card {
                padding: 10px;
            }
        }

        /* Popup Modal */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .popup-overlay.active {
            opacity: 1;
        }

        .popup-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .popup-overlay.active .popup-card {
            transform: scale(1);
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
        }

        .popup-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .popup-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #666;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .popup-close:hover {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            transform: rotate(90deg);
        }

        .popup-content {
            color: #333;
        }

        .popup-loading {
            text-align: center;
            padding: 40px 20px;
        }

        .popup-loading .loading {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: #4ade80;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto 20px;
        }

        .popup-loading-text {
            font-size: 1.1rem;
            color: #666;
            font-weight: 500;
        }

        .popup-plan {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #4ade80;
        }

        .popup-plan-item {
            color: #333;
            margin-bottom: 15px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 1rem;
            line-height: 1.5;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .popup-plan-item:last-child {
            border-bottom: none;
        }

        .popup-plan-item::before {
            content: "⏰";
            font-size: 1.2rem;
            color: #4ade80;
            min-width: 20px;
        }

        .popup-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .popup-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            min-width: 120px;
        }

        .popup-btn-primary {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: white;
        }

        .popup-btn-secondary {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .popup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        /* Mobile Responsive for Popup */
        @media (max-width: 768px) {
            .popup-card {
                width: 95%;
                padding: 20px;
                max-height: 85vh;
            }

            .popup-title {
                font-size: 1.5rem;
            }

            .popup-close {
                width: 35px;
                height: 35px;
                font-size: 1.5rem;
            }

            .popup-plan {
                padding: 20px;
            }

            .popup-plan-item {
                font-size: 0.95rem;
                padding: 10px 0;
            }

            .popup-actions {
                flex-direction: column;
                gap: 10px;
            }

            .popup-btn {
                width: 100%;
                padding: 15px 20px;
            }
        }

        @media (max-width: 480px) {
            .popup-card {
                width: 98%;
                padding: 15px;
            }

            .popup-title {
                font-size: 1.3rem;
            }

            .popup-plan-item {
                font-size: 0.9rem;
            }
        }

        /* Nature Music Player */
        .music-player {
            position: fixed;
            top: 30px;
            right: 100px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: none;
            flex-direction: column;
            gap: 10px;
            min-width: 200px;
        }

        .music-player.active {
            display: flex;
        }

        .music-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .music-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .music-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .music-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .music-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .music-btn.active {
            background: #4ade80;
        }

        .music-progress {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .music-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #22c55e);
            width: 0%;
            transition: width 0.3s ease;
        }

        .music-info {
            color: white;
            font-size: 0.8rem;
            text-align: center;
            opacity: 0.9;
        }

        .music-volume {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 0.8rem;
        }

        .volume-slider {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            background: #4ade80;
            border-radius: 50%;
            cursor: pointer;
        }

        .music-tracks {
            display: flex;
            flex-direction: column;
            gap: 5px;
            max-height: 120px;
            overflow-y: auto;
        }

        .music-track {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            color: white;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .music-track:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .music-track.active {
            background: #4ade80;
            color: white;
        }

        .music-track-icon {
            font-size: 0.9rem;
        }

        /* Mobile Responsive for Music Player */
        @media (max-width: 768px) {
            .music-player {
                top: 20px;
                right: 80px;
                min-width: 180px;
                padding: 12px;
            }

            .music-controls {
                gap: 6px;
            }

            .music-btn {
                width: 30px;
                height: 30px;
                font-size: 0.9rem;
            }

            .music-tracks {
                max-height: 100px;
            }
        }

        @media (max-width: 480px) {
            .music-player {
                top: 15px;
                right: 70px;
                min-width: 160px;
                padding: 10px;
            }

            .music-header {
                font-size: 0.8rem;
            }

            .music-track {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-text">🌙 Hey LAXMI, Welcome Back to Your study 🌲</div>
    </div>

    <!-- Background Slideshow -->
    <div class="background-container">
        <div class="background-slide active" style="background-image: url('1.jpg')"></div>
        <div class="background-slide" style="background-image: url('2.jpg')"></div>
        <div class="background-slide" style="background-image: url('3.jpg')"></div>
        <div class="background-slide" style="background-image: url('4.jpg')"></div>
    </div>

    <!-- Audio Controls -->
    <div class="audio-controls">
        <button class="audio-btn" id="toggleAudio" title="Toggle Background Music" onclick="toggleMusicPlayer()">🎵</button>
    </div>

    <!-- AI Chat Companion -->
    <div class="ai-companion">
        <button class="chat-btn" id="chatBtn" title="Chat with AI Coach">🤖</button>
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <span>AI Study Coach</span>
                <button onclick="toggleChat()" style="background: none; border: none; font-size: 1.2rem; cursor: pointer;">✕</button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message ai">Hello Laxmi! 🌿 I'm here to help you stay focused and motivated. How are you feeling today?</div>
            </div>
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="Type your message..." onkeypress="handleChatKeyPress(event)">
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div class="main-container">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h1 class="dashboard-title">🌿 Welcome, LAXMI 🌿</h1>
            <div class="dashboard-subtitle">Your AI-Powered Study Sanctuary</div>
        </div>

        <!-- Main Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Live Clock Card -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">🕐</div>
                    <div class="card-title">Live Clock</div>
                </div>
                <div class="card-content">
                    <div class="time-section">
                        <div class="live-clock" id="liveClock"></div>
                        <div class="date-display" id="currentDate"></div>
                    </div>
                </div>
            </div>

            <!-- NEET Countdown Card -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">🎯</div>
                    <div class="card-title">NEET Countdown</div>
                </div>
                <div class="card-content">
                    <div class="countdown-section">
                        <div class="countdown-card">
                            <div class="countdown-title">Days to NEET UG 2026</div>
                            <div class="countdown-value" id="neetCountdown"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Motivational Quote Card -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">💭</div>
                    <div class="card-title">Daily Motivation</div>
                </div>
                <div class="card-content">
                    <div class="quote-section">
                        <div class="quote-text" id="quoteText"></div>
                        <div class="quote-author" id="quoteAuthor"></div>
                    </div>
                </div>
            </div>

            <!-- Stopwatch Card -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">⏱️</div>
                    <div class="card-title">Stopwatch</div>
                </div>
                <div class="card-content">
                    <div class="timer-section">
                        <div class="timer-card">
                            <div class="timer-display" id="stopwatchDisplay">00:00:00</div>
                            <div class="timer-controls">
                                <button class="btn btn-primary" id="startStopwatch">Start</button>
                                <button class="btn btn-secondary" id="resetStopwatch">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Countdown Timer Card -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">⏰</div>
                    <div class="card-title">Countdown Timer</div>
                </div>
                <div class="card-content">
                    <div class="timer-section">
                        <div class="timer-card">
                            <div class="timer-display" id="countdownDisplay">00:00:00</div>
                            <div class="countdown-input">
                                <div>
                                    <input type="number" class="time-input" id="hoursInput" placeholder="00" min="0" max="23">
                                    <div class="time-label">Hours</div>
                                </div>
                                <div>
                                    <input type="number" class="time-input" id="minutesInput" placeholder="00" min="0" max="59">
                                    <div class="time-label">Minutes</div>
                                </div>
                                <div>
                                    <input type="number" class="time-input" id="secondsInput" placeholder="00" min="0" max="59">
                                    <div class="time-label">Seconds</div>
                                </div>
                            </div>
                            <div class="timer-controls">
                                <button class="btn btn-primary" id="startCountdown">Start</button>
                                <button class="btn btn-danger" id="resetCountdown">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Features Section -->
        <div class="ai-features">
            <!-- Study Planner -->
            <div class="ai-card">
                <div class="ai-title">📚 AI Study Planner</div>
                <div class="ai-content" id="studyPlanContent">
                    <button class="btn btn-info" onclick="generateStudyPlan()">Generate Today's Plan</button>
                </div>
            </div>

            <!-- Focus Tracker -->
            <div class="ai-card">
                <div class="ai-title">📊 Focus Tracker</div>
                <div class="focus-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="todayFocus">0h 0m</div>
                        <div class="stat-label">Today</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="weekFocus">0h 0m</div>
                        <div class="stat-label">This Week</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="streak">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                </div>
                <div class="ai-content" id="focusFeedback"></div>
            </div>

            <!-- Mood Tracker -->
            <div class="ai-card">
                <div class="ai-title">🧘‍♀️ Mood Tracker</div>
                <div class="ai-content">How are you feeling right now?</div>
                <div class="mood-buttons">
                    <button class="mood-btn mood-happy" onclick="setMood('happy')">😊 Happy</button>
                    <button class="mood-btn mood-focused" onclick="setMood('focused')">🎯 Focused</button>
                    <button class="mood-btn mood-tired" onclick="setMood('tired')">😴 Tired</button>
                    <button class="mood-btn mood-stressed" onclick="setMood('stressed')">😰 Stressed</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Study Plan Popup -->
    <div class="popup-overlay" id="studyPlanPopup">
        <div class="popup-card">
            <div class="popup-header">
                <div class="popup-title">
                    📚 Today's Study Plan
                </div>
                <button class="popup-close" onclick="closeStudyPlanPopup()">✕</button>
            </div>
            <div class="popup-content" id="popupContent">
                <div class="popup-loading">
                    <div class="loading"></div>
                    <div class="popup-loading-text">Generating your personalized study plan...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="backgroundAudio" loop>
        <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    </audio>
    <audio id="timerAudio">
        <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    </audio>

    <!-- Nature Music Player -->
    <div class="music-player" id="musicPlayer">
        <div class="music-header">
            <span>🌿 Nature Sounds</span>
            <button class="music-close" onclick="toggleMusicPlayer()">✕</button>
        </div>
        <div class="music-controls">
            <button class="music-btn" id="playPauseBtn" onclick="togglePlayPause()">▶️</button>
            <div class="music-progress" onclick="seekMusic(event)">
                <div class="music-progress-bar" id="musicProgressBar"></div>
            </div>
            <button class="music-btn" id="nextBtn" onclick="nextTrack()">⏭️</button>
        </div>
        <div class="music-info">
            <span id="currentSong">Forest Ambience</span>
        </div>
        <div class="music-volume">
            <span>🔊</span>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50" oninput="updateVolume()">
        </div>
        <div class="music-tracks">
            <button class="music-track active" data-track="forest" onclick="playTrack('forest')">
                <span class="music-track-icon">🌲</span> Forest Ambience
            </button>
        </div>
    </div>

    <script>
        // Configuration - Replace with your actual Gemini API key
        const GEMINI_API_KEY = 'AIzaSyAbAofKDdTW4vKzkv9aD8yKLyZXo99HJ5w';
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent';

        // User Data Storage
        let userData = {
            focusTime: {
                today: 0,
                week: 0,
                streak: 0
            },
            mood: 'focused',
            studyHistory: [],
            lastStudyDate: null
        };

        // Load user data from localStorage
        function loadUserData() {
            const saved = localStorage.getItem('laxmiStudyData');
            if (saved) {
                userData = JSON.parse(saved);
            }
        }

        // Save user data to localStorage
        function saveUserData() {
            localStorage.setItem('laxmiStudyData', JSON.stringify(userData));
        }

        // Initialize user data
        loadUserData();

        // Splash Screen
        setTimeout(() => {
            document.getElementById('splashScreen').classList.add('fade-out');
            setTimeout(() => {
                document.getElementById('splashScreen').style.display = 'none';
            }, 1000);
        }, 3000);

        // Background Slideshow
        const backgrounds = document.querySelectorAll('.background-slide');
        let currentBg = 0;

        function changeBackground() {
            backgrounds[currentBg].classList.remove('active');
            currentBg = (currentBg + 1) % backgrounds.length;
            backgrounds[currentBg].classList.add('active');
        }

        setInterval(changeBackground, 15000);

        // Live Clock
        function updateClock() {
            const now = new Date();
            const options = {
                timeZone: 'Asia/Kolkata',
                hour12: true,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            document.getElementById('liveClock').textContent = now.toLocaleTimeString('en-US', options);
        }

        setInterval(updateClock, 1000);
        updateClock();

        // NEET Countdown
        function updateNEETCountdown() {
            const neetDate = new Date('May 3, 2026');
            const now = new Date();
            const diff = neetDate - now;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            document.getElementById('neetCountdown').textContent = days;
        }

        function updateCurrentDate() {
            const now = new Date();
            const options = {
                timeZone: 'Asia/Kolkata',
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', options);
        }

        updateNEETCountdown();
        updateCurrentDate();
        setInterval(updateNEETCountdown, 86400000);

        // AI Quote Generator
        async function generateAIQuote() {
            try {
                const prompt = `Generate a motivational quote for a student named Laxmi who is preparing for NEET UG exam. The quote should be inspiring, relevant to studying, and include the author's name. Keep it concise and uplifting. Current time: ${new Date().toLocaleTimeString('en-US', {timeZone: 'Asia/Kolkata'})}`;
                
                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                if (data.candidates && data.candidates[0].content.parts[0].text) {
                    const quote = data.candidates[0].content.parts[0].text;
                    const lines = quote.split('\n');
                    document.getElementById('quoteText').textContent = lines[0];
                    if (lines[1]) {
                        document.getElementById('quoteAuthor').textContent = lines[1];
                    } else {
                        document.getElementById('quoteAuthor').textContent = '';
                    }
                } else {
                    throw new Error('No valid response from AI');
                }
            } catch (error) {
                console.log('AI quote generation failed, using fallback:', error);
                useFallbackQuotes();
            }
        }

        function useFallbackQuotes() {
            const quotes = [
                {
                    text: "The only way to do great work is to love what you do.",
                    author: "- Steve Jobs"
                },
                {
                    text: "Success is not final, failure is not fatal: it is the courage to continue that counts.",
                    author: "- Winston Churchill"
                },
                {
                    text: "The future belongs to those who believe in the beauty of their dreams.",
                    author: "- Eleanor Roosevelt"
                },
                {
                    text: "Don't watch the clock; do what it does. Keep going.",
                    author: "- Sam Levenson"
                },
                {
                    text: "The only limit to our realization of tomorrow will be our doubts of today.",
                    author: "- Franklin D. Roosevelt"
                },
                {
                    text: "Believe you can and you're halfway there.",
                    author: "- Theodore Roosevelt"
                },
                {
                    text: "It always seems impossible until it's done.",
                    author: "- Nelson Mandela"
                },
                {
                    text: "The way to get started is to quit talking and begin doing.",
                    author: "- Walt Disney"
                },
                {
                    text: "Your time is limited, don't waste it living someone else's life.",
                    author: "- Steve Jobs"
                },
                {
                    text: "The only person you are destined to become is the person you decide to be.",
                    author: "- Ralph Waldo Emerson"
                },
                {
                    text: "Education is the most powerful weapon which you can use to change the world.",
                    author: "- Nelson Mandela"
                },
                {
                    text: "The beautiful thing about learning is that nobody can take it away from you.",
                    author: "- B.B. King"
                },
                {
                    text: "Study hard, for the well is deep, and our brains are shallow.",
                    author: "- Richard Baxter"
                },
                {
                    text: "The expert in anything was once a beginner.",
                    author: "- Helen Hayes"
                },
                {
                    text: "Learning never exhausts the mind.",
                    author: "- Leonardo da Vinci"
                }
            ];
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('quoteText').textContent = randomQuote.text;
            document.getElementById('quoteAuthor').textContent = randomQuote.author;
        }

        // Initialize with a fallback quote immediately
        useFallbackQuotes();

        // Generate AI quote every 30 seconds (increased from 10 seconds to reduce API calls)
        setTimeout(generateAIQuote, 2000); // First AI attempt after 2 seconds
        setInterval(generateAIQuote, 30000); // Then every 30 seconds

        // AI Study Planner
        async function generateStudyPlan() {
            // Show popup
            const popup = document.getElementById('studyPlanPopup');
            const popupContent = document.getElementById('popupContent');
            
            popup.style.display = 'flex';
            setTimeout(() => {
                popup.classList.add('active');
            }, 10);

            // Show loading state
            popupContent.innerHTML = `
                <div class="popup-loading">
                    <div class="loading"></div>
                    <div class="popup-loading-text">Generating your personalized study plan...</div>
                </div>
            `;

            try {
                const currentTime = new Date().toLocaleTimeString('en-US', {timeZone: 'Asia/Kolkata'});
                const currentDate = new Date().toLocaleDateString('en-US', {timeZone: 'Asia/Kolkata'});
                const focusTime = userData.focusTime.today;
                const focusHours = Math.floor(focusTime / 3600);
                const focusMinutes = Math.floor((focusTime % 3600) / 60);
                const weekHours = Math.floor(userData.focusTime.week / 3600);
                const weekMinutes = Math.floor((userData.focusTime.week % 3600) / 60);
                const neetDays = document.getElementById('neetCountdown').textContent;
                const currentMood = userData.mood;
                const studyStreak = userData.focusTime.streak;
                
                const prompt = `You are an expert NEET preparation coach creating a personalized daily study plan for Laxmi.

COMPREHENSIVE CONTEXT:
- Current time: ${currentTime} (IST)
- Current date: ${currentDate}
- Today's study time so far: ${focusHours}h ${focusMinutes}m
- This week's study time: ${weekHours}h ${weekMinutes}m
- Days until NEET UG 2026: ${neetDays}
- Current mood: ${currentMood}
- Study streak: ${studyStreak} days

STUDY PLAN REQUIREMENTS:
Create a detailed, personalized study plan that includes:

1. 6-7 study sessions with specific NEET subjects (Physics, Chemistry, Biology)
2. Realistic break times (15-20 minutes) with suggested activities
3. Subject-specific study techniques and focus areas
4. Practice question sessions and revision slots
5. Energy management based on her current mood
6. Specific NEET topics or chapters to focus on
7. Motivational elements and progress tracking
8. Time management strategies
9. Study environment optimization tips
10. Next steps and follow-up actions

FORMAT REQUIREMENTS:
- Use clear time slots (e.g., "9:00 AM - 10:30 AM")
- Include specific subject topics (e.g., "Physics: Mechanics & Motion")
- Add study techniques (e.g., "Practice problems", "Mind mapping")
- Include motivational notes
- Make it achievable and realistic
- Consider her current energy levels and mood

SPECIAL CONSIDERATIONS:
- If she's tired: Include lighter study tasks and more breaks
- If she's stressed: Focus on breaking down complex topics
- If she's motivated: Include challenging but achievable goals
- If she's focused: Maximize productivity with intensive sessions

Make this plan feel personal and tailored specifically for Laxmi's NEET preparation journey.`;

                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                const data = await response.json();
                
                if (data.candidates && data.candidates[0].content.parts[0].text) {
                    const plan = data.candidates[0].content.parts[0].text;
                    const planItems = plan.split('\n').filter(item => item.trim());
                    
                    let planHTML = '<div class="popup-plan">';
                    planItems.forEach(item => {
                        if (item.trim()) {
                            planHTML += `<div class="popup-plan-item">${item}</div>`;
                        }
                    });
                    planHTML += '</div>';
                    
                    planHTML += `
                        <div class="popup-actions">
                            <button class="popup-btn popup-btn-primary" onclick="saveStudyPlan()">Save Plan</button>
                            <button class="popup-btn popup-btn-secondary" onclick="generateStudyPlan()">Regenerate</button>
                        </div>
                    `;
                    
                    popupContent.innerHTML = planHTML;
                    
                    // Also update the main dashboard
                    document.getElementById('studyPlanContent').innerHTML = planHTML;
                } else {
                    throw new Error('No response from AI');
                }
            } catch (error) {
                console.log('AI study plan generation failed:', error);
                const fallbackPlan = `
                    <div class="popup-plan">
                        <div class="popup-plan-item">9:00 AM - 10:30 AM: Physics (Mechanics & Motion) - Focus on problem-solving and practice questions</div>
                        <div class="popup-plan-item">10:30 AM - 10:45 AM: Break - Stretch, hydrate, and take deep breaths</div>
                        <div class="popup-plan-item">10:45 AM - 12:15 PM: Chemistry (Organic Chemistry) - Practice reaction mechanisms and solve numerical problems</div>
                        <div class="popup-plan-item">12:15 PM - 1:00 PM: Lunch Break - Healthy meal and short walk for fresh air</div>
                        <div class="popup-plan-item">1:00 PM - 2:30 PM: Biology (Human Anatomy) - Create mind maps and focus on important diagrams</div>
                        <div class="popup-plan-item">2:30 PM - 2:45 PM: Break - Eye exercises and quick meditation</div>
                        <div class="popup-plan-item">2:45 PM - 4:15 PM: Practice Questions & Revision - Mix of all subjects with focus on weak areas</div>
                        <div class="popup-plan-item">4:15 PM - 4:30 PM: End of Study Session - Review today's progress and plan tomorrow's goals</div>
                    </div>
                    <div class="popup-actions">
                        <button class="popup-btn popup-btn-primary" onclick="saveStudyPlan()">Save Plan</button>
                        <button class="popup-btn popup-btn-secondary" onclick="generateStudyPlan()">Regenerate</button>
                    </div>
                `;
                
                popupContent.innerHTML = fallbackPlan;
                document.getElementById('studyPlanContent').innerHTML = fallbackPlan;
            }
        }

        function closeStudyPlanPopup() {
            const popup = document.getElementById('studyPlanPopup');
            popup.classList.remove('active');
            setTimeout(() => {
                popup.style.display = 'none';
            }, 300);
        }

        function saveStudyPlan() {
            // Save the current plan to localStorage
            const planContent = document.querySelector('.popup-plan');
            if (planContent) {
                localStorage.setItem('laxmiStudyPlan', planContent.innerHTML);
                alert('Study plan saved successfully! 📚');
            }
            closeStudyPlanPopup();
        }

        // Close popup when clicking outside
        document.getElementById('studyPlanPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                closeStudyPlanPopup();
            }
        });

        // Close popup with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeStudyPlanPopup();
            }
        });

        // Focus Tracker
        function updateFocusStats() {
            const todayHours = Math.floor(userData.focusTime.today / 3600);
            const todayMinutes = Math.floor((userData.focusTime.today % 3600) / 60);
            const weekHours = Math.floor(userData.focusTime.week / 3600);
            const weekMinutes = Math.floor((userData.focusTime.week % 3600) / 60);

            document.getElementById('todayFocus').textContent = `${todayHours}h ${todayMinutes}m`;
            document.getElementById('weekFocus').textContent = `${weekHours}h ${weekMinutes}m`;
            document.getElementById('streak').textContent = userData.focusTime.streak;

            generateFocusFeedback();
        }

        async function generateFocusFeedback() {
            try {
                const currentTime = new Date().toLocaleTimeString('en-US', {timeZone: 'Asia/Kolkata'});
                const focusTime = userData.focusTime.today;
                const focusHours = Math.floor(focusTime / 3600);
                const focusMinutes = Math.floor((focusTime % 3600) / 60);
                const weekHours = Math.floor(userData.focusTime.week / 3600);
                const weekMinutes = Math.floor((userData.focusTime.week % 3600) / 60);
                const neetDays = document.getElementById('neetCountdown').textContent;
                
                const prompt = `Laxmi's Study Progress Report:

Current Status:
- Today's study time: ${focusHours}h ${focusMinutes}m
- This week's study time: ${weekHours}h ${weekMinutes}m
- Study streak: ${userData.focusTime.streak} days
- Days until NEET UG 2026: ${neetDays}
- Current time: ${currentTime} (IST)

Provide a personalized, encouraging feedback message (max 2 sentences) that:
1. Acknowledges her current progress
2. Offers specific motivation or advice
3. Relates to her NEET preparation goals
4. Uses her name personally
5. Includes relevant emojis
6. Suggests next steps if appropriate

Make it warm, supportive, and tailored to her study situation.`;

                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                const data = await response.json();
                if (data.candidates && data.candidates[0].content.parts[0].text) {
                    document.getElementById('focusFeedback').textContent = data.candidates[0].content.parts[0].text;
                } else {
                    throw new Error('No AI response');
                }
            } catch (error) {
                console.log('AI feedback generation failed:', error);
                // Enhanced fallback feedback based on study time
                const focusTime = userData.focusTime.today;
                const focusHours = Math.floor(focusTime / 3600);
                const focusMinutes = Math.floor((focusTime % 3600) / 60);
                
                let fallbackMessage = '';
                if (focusTime === 0) {
                    fallbackMessage = "Ready to start your study session, Laxmi? 🌟 Every minute counts towards your NEET goal!";
                } else if (focusTime < 3600) { // Less than 1 hour
                    fallbackMessage = "Great start, Laxmi! 🌿 Keep building momentum. Every study session brings you closer to success!";
                } else if (focusTime < 7200) { // 1-2 hours
                    fallbackMessage = "Excellent progress, Laxmi! 💪 You're building a strong foundation. Keep up this consistent effort!";
                } else if (focusTime < 14400) { // 2-4 hours
                    fallbackMessage = "Outstanding dedication, Laxmi! 🎯 Your focus and discipline are truly inspiring. You're on the right track!";
                } else { // More than 4 hours
                    fallbackMessage = "Incredible work ethic, Laxmi! 🌟 Your commitment to excellence is remarkable. Remember to take well-deserved breaks!";
                }
                
                document.getElementById('focusFeedback').textContent = fallbackMessage;
            }
        }

        // Mood Tracker
        function setMood(mood) {
            userData.mood = mood;
            saveUserData();

            document.body.className = '';
            if (mood === 'tired') {
                document.body.classList.add('mood-tired');
            } else if (mood === 'happy') {
                document.body.classList.add('mood-motivated');
            }

            addChatMessage('user', `I'm feeling ${mood} today.`);
            generateMoodResponse(mood);
        }

        async function generateMoodResponse(mood) {
            try {
                const currentTime = new Date().toLocaleTimeString('en-US', {timeZone: 'Asia/Kolkata'});
                const currentDate = new Date().toLocaleDateString('en-US', {timeZone: 'Asia/Kolkata'});
                const focusTime = userData.focusTime.today;
                const focusHours = Math.floor(focusTime / 3600);
                const focusMinutes = Math.floor((focusTime % 3600) / 60);
                const weekHours = Math.floor(userData.focusTime.week / 3600);
                const weekMinutes = Math.floor((userData.focusTime.week % 3600) / 60);
                const neetDays = document.getElementById('neetCountdown').textContent;
                const studyStreak = userData.focusTime.streak;
                
                const prompt = `You are an advanced AI Study Coach for Laxmi, a NEET UG aspirant.

MOOD ANALYSIS CONTEXT:
- Current mood: ${mood}
- Current time: ${currentTime} (IST)
- Current date: ${currentDate}
- Today's study time: ${focusHours}h ${focusMinutes}m
- This week's study time: ${weekHours}h ${weekMinutes}m
- Study streak: ${studyStreak} days
- Days until NEET UG 2026: ${neetDays}

MOOD-SPECIFIC GUIDANCE:
Based on Laxmi's current mood (${mood}), provide a personalized response that:

1. Acknowledges and validates her current emotional state
2. Offers specific, actionable advice for her mood
3. Suggests appropriate study strategies for her current energy level
4. Provides motivation that matches her emotional state
5. Recommends practical steps to optimize her study session
6. Uses her name personally and feels supportive
7. Includes relevant emojis for encouragement
8. Keeps response under 100 words but comprehensive

SPECIAL CONSIDERATIONS:
- If tired: Suggest lighter study tasks, breaks, and energy-boosting activities
- If stressed: Offer stress-management techniques and breaking down tasks
- If happy: Channel positive energy into productive study strategies
- If focused: Encourage maintaining momentum and optimizing study techniques

Make your response feel like it comes from a coach who truly understands her situation and can help her make the most of her current state.`;

                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                const data = await response.json();
                
                if (data.candidates && data.candidates[0].content.parts[0].text) {
                    setTimeout(() => {
                        addChatMessage('ai', data.candidates[0].content.parts[0].text);
                    }, 1000);
                } else {
                    throw new Error('No AI response');
                }
            } catch (error) {
                console.log('AI mood response failed:', error);
                // Enhanced fallback responses with more context
                const focusTime = userData.focusTime.today;
                const focusHours = Math.floor(focusTime / 3600);
                const neetDays = document.getElementById('neetCountdown').textContent;
                
                const fallbackResponses = {
                    'happy': `That's wonderful, Laxmi! 😊 Your positive energy is perfect for productive study sessions. With ${neetDays} days until NEET, let's channel this happiness into focused learning!`,
                    'focused': `Perfect mindset for studying! 🎯 You're in the zone with ${focusHours}h of study today. Let's maximize this focused energy and tackle those challenging NEET topics!`,
                    'tired': `It's okay to feel tired, Laxmi. 😴 You've studied for ${focusHours}h today - that's commendable! Maybe take a 15-minute break, hydrate, and try a lighter study session. Rest is part of the journey!`,
                    'stressed': `I understand you're feeling stressed, Laxmi. 😰 With ${neetDays} days until NEET, it's natural. Take a deep breath and let's break down your study goals into smaller, manageable tasks. You've got this!`
                };
                
                setTimeout(() => {
                    addChatMessage('ai', fallbackResponses[mood] || 'Thank you for sharing how you feel, Laxmi. I\'m here to support you through your NEET preparation journey! 🌿');
                }, 1000);
            }
        }

        // AI Chat Companion
        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            chatWindow.style.display = chatWindow.style.display === 'flex' ? 'none' : 'flex';
        }

        document.getElementById('chatBtn').addEventListener('click', toggleChat);

        function addChatMessage(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage('user', message);
                input.value = '';

                // Show typing indicator
                const typingDiv = document.createElement('div');
                typingDiv.className = 'message ai';
                typingDiv.innerHTML = '<span class="loading"></span> AI is thinking...';
                document.getElementById('chatMessages').appendChild(typingDiv);

                try {
                    // Enhanced context-aware prompt with comprehensive data
                    const currentTime = new Date().toLocaleTimeString('en-US', {timeZone: 'Asia/Kolkata'});
                    const currentDate = new Date().toLocaleDateString('en-US', {timeZone: 'Asia/Kolkata'});
                    const focusTime = userData.focusTime.today;
                    const focusHours = Math.floor(focusTime / 3600);
                    const focusMinutes = Math.floor((focusTime % 3600) / 60);
                    const weekHours = Math.floor(userData.focusTime.week / 3600);
                    const weekMinutes = Math.floor((userData.focusTime.week % 3600) / 60);
                    const neetDays = document.getElementById('neetCountdown').textContent;
                    const currentMood = userData.mood;
                    const studyStreak = userData.focusTime.streak;
                    
                    const prompt = `You are an advanced AI Study Coach for Laxmi, a dedicated NEET UG aspirant preparing for medical school entrance.

COMPREHENSIVE CONTEXT:
- Current time: ${currentTime} (IST)
- Current date: ${currentDate}
- Today's study time: ${focusHours}h ${focusMinutes}m
- This week's study time: ${weekHours}h ${weekMinutes}m
- Days until NEET UG 2026: ${neetDays}
- Current mood: ${currentMood}
- Study streak: ${studyStreak} days
- User's message: "${message}"

YOUR ROLE:
You are an expert NEET preparation coach with deep knowledge of:
- Physics, Chemistry, and Biology for medical entrance
- Study techniques and time management
- Mental health and motivation strategies
- NEET exam patterns and preparation strategies
- Indian medical education system

RESPONSE GUIDELINES:
1. Always use Laxmi's name personally
2. Provide specific, actionable advice for NEET preparation
3. Reference her current study progress and streak
4. Suggest relevant study techniques or time management tips
5. Offer subject-specific guidance when relevant (Physics/Chemistry/Biology)
6. Include motivational elements and encouragement
7. Keep responses under 120 words but make them comprehensive
8. Use a warm, supportive, and professional tone
9. Include relevant emojis for encouragement
10. Consider her current mood and energy levels
11. Provide specific next steps or study recommendations
12. Reference the NEET countdown when motivating

SPECIAL INSTRUCTIONS:
- If she asks about specific subjects, provide detailed study strategies
- If she's feeling tired/stressed, offer practical coping strategies
- If she's motivated, channel that energy into productive study advice
- If she needs motivation, remind her of her progress and goals
- Always relate advice back to her NEET preparation journey

Respond as her personal AI coach who truly understands her situation and goals.`;

                    const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }]
                        })
                    });

                    const data = await response.json();
                    
                    // Remove typing indicator
                    typingDiv.remove();
                    
                    if (data.candidates && data.candidates[0].content.parts[0].text) {
                        addChatMessage('ai', data.candidates[0].content.parts[0].text);
                    } else {
                        addChatMessage('ai', getFallbackResponse(message));
                    }
                } catch (error) {
                    console.log('AI chat response failed:', error);
                    typingDiv.remove();
                    addChatMessage('ai', getFallbackResponse(message));
                }
            }
        }

        function getFallbackResponse(userMessage) {
            const responses = {
                // Study-related responses
                'study': 'Keep up the great work, Laxmi! 🌟 Remember to take short breaks every 45 minutes to maintain focus. You\'re making excellent progress!',
                'tired': 'It\'s okay to feel tired, Laxmi. 😴 Maybe take a 15-minute break, drink some water, and try a lighter study session. Rest is part of the journey!',
                'motivation': 'You\'ve got this, Laxmi! 💪 Every minute you study brings you closer to your NEET goal. Your dedication is inspiring!',
                'help': 'I\'m here to support you, Laxmi! 🌿 What specific help do you need with your studies today?',
                'time': 'Time management is key, Laxmi! ⏰ Try the Pomodoro technique: 25 minutes of focused study, then 5 minutes break.',
                'stress': 'Take a deep breath, Laxmi. 😌 Break down your study goals into smaller, manageable tasks. You\'re doing great!',
                'physics': 'Physics can be challenging, Laxmi! 🔬 Try solving practice problems step by step. Understanding the concepts is more important than memorizing.',
                'chemistry': 'Chemistry requires practice, Laxmi! 🧪 Focus on understanding mechanisms and reactions. Practice makes perfect!',
                'biology': 'Biology is fascinating, Laxmi! 🧬 Try creating mind maps to connect different concepts. Visual learning helps retention!',
                'neet': `You have ${document.getElementById('neetCountdown').textContent} days until NEET, Laxmi! 🎯 Stay focused, stay consistent. Every day counts!`,
                'break': 'Taking breaks is important, Laxmi! 🌸 Use this time to stretch, hydrate, or take a short walk. You\'ll come back refreshed!',
                'focus': 'Focus comes with practice, Laxmi! 🎯 Try eliminating distractions and setting specific study goals for each session.',
                'progress': 'You\'re making amazing progress, Laxmi! 📈 Every study session adds to your knowledge. Keep going!',
                'difficult': 'Challenges make you stronger, Laxmi! 💪 Don\'t give up. Break difficult topics into smaller parts and tackle them one by one.',
                'success': 'Success is within your reach, Laxmi! 🌟 Stay consistent, stay motivated, and believe in yourself. You\'ve got this!'
            };

            // Check for keywords in the message
            const lowerMessage = userMessage.toLowerCase();
            for (const [keyword, response] of Object.entries(responses)) {
                if (lowerMessage.includes(keyword)) {
                    return response;
                }
            }

            // Default encouraging response
            return 'Thank you for sharing, Laxmi! 🌿 I\'m here to support you through your NEET journey. How can I help you stay motivated today?';
        }

        // Add smart study tips
        function addSmartStudyTip() {
            const tips = [
                "💡 Tip: Try the Pomodoro Technique - 25 minutes of focused study, then 5 minutes break!",
                "📚 Tip: Create mind maps for complex topics to better understand connections!",
                "⏰ Tip: Study your most challenging subjects when you're most alert!",
                "🎯 Tip: Set specific, achievable goals for each study session!",
                "🧠 Tip: Review your notes within 24 hours to improve retention!",
                "💪 Tip: Take short breaks every 45 minutes to maintain focus!",
                "📝 Tip: Practice active recall by testing yourself on what you've learned!",
                "🌿 Tip: Study in a well-lit, comfortable environment for better concentration!"
            ];
            
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            setTimeout(() => {
                addChatMessage('ai', randomTip);
            }, 5000); // Show tip after 5 seconds of inactivity
        }

        // Initialize chat with welcome message
        setTimeout(() => {
            const currentTime = new Date().getHours();
            let greeting = "Good morning";
            if (currentTime >= 12 && currentTime < 17) {
                greeting = "Good afternoon";
            } else if (currentTime >= 17) {
                greeting = "Good evening";
            }
            
            addChatMessage('ai', `${greeting}, Laxmi! 🌿 I'm your AI Study Coach, here to help you stay focused and motivated for your NEET preparation. How are you feeling today?`);
        }, 2000);

        // Stopwatch with Focus Tracking
        let stopwatchInterval;
        let stopwatchRunning = false;
        let stopwatchTime = 0;
        let focusStartTime = null;

        function updateStopwatchDisplay() {
            const hours = Math.floor(stopwatchTime / 3600);
            const minutes = Math.floor((stopwatchTime % 3600) / 60);
            const seconds = stopwatchTime % 60;
            document.getElementById('stopwatchDisplay').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        document.getElementById('startStopwatch').addEventListener('click', function() {
            if (!stopwatchRunning) {
                stopwatchRunning = true;
                focusStartTime = Date.now();
                this.textContent = 'Pause';
                stopwatchInterval = setInterval(() => {
                    stopwatchTime++;
                    updateStopwatchDisplay();
                }, 1000);
            } else {
                stopwatchRunning = false;
                if (focusStartTime) {
                    const focusDuration = Math.floor((Date.now() - focusStartTime) / 1000);
                    userData.focusTime.today += focusDuration;
                    userData.focusTime.week += focusDuration;
                    saveUserData();
                    updateFocusStats();
                    focusStartTime = null;
                }
                this.textContent = 'Start';
                clearInterval(stopwatchInterval);
            }
        });

        document.getElementById('resetStopwatch').addEventListener('click', function() {
            stopwatchRunning = false;
            stopwatchTime = 0;
            focusStartTime = null;
            document.getElementById('startStopwatch').textContent = 'Start';
            clearInterval(stopwatchInterval);
            updateStopwatchDisplay();
        });

        // Countdown Timer
        let countdownInterval;
        let countdownRunning = false;
        let countdownTime = 0;

        function updateCountdownDisplay() {
            const hours = Math.floor(countdownTime / 3600);
            const minutes = Math.floor((countdownTime % 3600) / 60);
            const seconds = countdownTime % 60;
            document.getElementById('countdownDisplay').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        document.getElementById('startCountdown').addEventListener('click', function() {
            if (!countdownRunning) {
                const hours = parseInt(document.getElementById('hoursInput').value) || 0;
                const minutes = parseInt(document.getElementById('minutesInput').value) || 0;
                const seconds = parseInt(document.getElementById('secondsInput').value) || 0;
                
                countdownTime = hours * 3600 + minutes * 60 + seconds;
                
                if (countdownTime > 0) {
                    countdownRunning = true;
                    this.textContent = 'Pause';
                    countdownInterval = setInterval(() => {
                        countdownTime--;
                        updateCountdownDisplay();
                        
                        if (countdownTime <= 0) {
                            countdownRunning = false;
                            this.textContent = 'Start';
                            clearInterval(countdownInterval);
                            document.getElementById('timerAudio').play();
                            alert('Time\'s up! ⏰');
                        }
                    }, 1000);
                }
            } else {
                countdownRunning = false;
                this.textContent = 'Start';
                clearInterval(countdownInterval);
            }
        });

        document.getElementById('resetCountdown').addEventListener('click', function() {
            countdownRunning = false;
            countdownTime = 0;
            document.getElementById('startCountdown').textContent = 'Start';
            clearInterval(countdownInterval);
            updateCountdownDisplay();
            document.getElementById('hoursInput').value = '';
            document.getElementById('minutesInput').value = '';
            document.getElementById('secondsInput').value = '';
        });

        // Audio Controls
        let audioPlaying = false;
        const backgroundAudio = document.getElementById('backgroundAudio');
        const audioBtn = document.getElementById('toggleAudio');

        audioBtn.addEventListener('click', function() {
            if (audioPlaying) {
                backgroundAudio.pause();
                audioPlaying = false;
                this.textContent = '🔇';
            } else {
                backgroundAudio.play().catch(e => console.log('Audio play failed:', e));
                audioPlaying = true;
                this.textContent = '🎵';
            }
        });

        // Daily streak tracking
        function checkDailyStreak() {
            const today = new Date().toDateString();
            if (userData.lastStudyDate !== today) {
                if (userData.lastStudyDate === new Date(Date.now() - 86400000).toDateString()) {
                    userData.focusTime.streak++;
                } else if (userData.lastStudyDate !== today) {
                    userData.focusTime.streak = 0;
                }
                userData.lastStudyDate = today;
                userData.focusTime.today = 0;
                saveUserData();
            }
        }

        // Initialize everything
        checkDailyStreak();
        updateClock();
        updateNEETCountdown();
        updateCurrentDate();
        updateFocusStats();
        updateStopwatchDisplay();
        updateCountdownDisplay();

        // Reset weekly focus time on Monday
        const now = new Date();
        if (now.getDay() === 1 && !localStorage.getItem('weekReset')) {
            userData.focusTime.week = 0;
            localStorage.setItem('weekReset', 'true');
            saveUserData();
        } else if (now.getDay() !== 1) {
            localStorage.removeItem('weekReset');
        }

        // Nature Music Player
        const natureTracks = {
            forest: {
                name: "Forest Ambience",
                url: "https://www.soundjay.com/misc/sounds/forest-ambience.mp3",
                icon: "🌲"
            }
        };

        let currentTrack = 'forest';
        let isPlaying = false;

        function toggleMusicPlayer() {
            const musicPlayer = document.getElementById('musicPlayer');
            musicPlayer.classList.toggle('active');
        }

        function playTrack(trackName) {
            // Update active track button
            document.querySelectorAll('.music-track').forEach(track => {
                track.classList.remove('active');
            });
            document.querySelector(`[data-track="${trackName}"]`).classList.add('active');

            // Update current track
            currentTrack = trackName;
            const track = natureTracks[trackName];
            
            // Update audio source and play
            backgroundAudio.src = track.url;
            backgroundAudio.play().then(() => {
                isPlaying = true;
                updatePlayPauseButton();
                updateCurrentSong();
            }).catch(error => {
                console.log('Audio play failed:', error);
                // Fallback to a working audio source
                backgroundAudio.src = "nurture sounds.mp3";
            });
        }

        function togglePlayPause() {
            if (isPlaying) {
                backgroundAudio.pause();
                isPlaying = false;
            } else {
                backgroundAudio.play();
                isPlaying = true;
            }
            updatePlayPauseButton();
        }

        function updatePlayPauseButton() {
            const btn = document.getElementById('playPauseBtn');
            btn.textContent = isPlaying ? '⏸️' : '▶️';
        }

        function updateCurrentSong() {
            const track = natureTracks[currentTrack];
            document.getElementById('currentSong').textContent = track.name;
        }

        function nextTrack() {
            const trackNames = Object.keys(natureTracks);
            const currentIndex = trackNames.indexOf(currentTrack);
            const nextIndex = (currentIndex + 1) % trackNames.length;
            playTrack(trackNames[nextIndex]);
        }

        function seekMusic(event) {
            const progressBar = event.currentTarget;
            const rect = progressBar.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = (clickX / rect.width) * 100;
            
            if (backgroundAudio.duration) {
                backgroundAudio.currentTime = (backgroundAudio.duration * percentage) / 100;
            }
        }

        function updateVolume() {
            const volumeSlider = document.getElementById('volumeSlider');
            backgroundAudio.volume = volumeSlider.value / 100;
        }

        function updateMusicProgress() {
            if (backgroundAudio.duration && !isNaN(backgroundAudio.duration)) {
                const progress = (backgroundAudio.currentTime / backgroundAudio.duration) * 100;
                document.getElementById('musicProgressBar').style.width = progress + '%';
            }
        }

        // Audio event listeners
        backgroundAudio.addEventListener('play', () => {
            isPlaying = true;
            updatePlayPauseButton();
        });

        backgroundAudio.addEventListener('pause', () => {
            isPlaying = false;
            updatePlayPauseButton();
        });

        backgroundAudio.addEventListener('timeupdate', updateMusicProgress);

        backgroundAudio.addEventListener('ended', () => {
            // Loop the current track
            backgroundAudio.currentTime = 0;
            backgroundAudio.play();
        });

        // Initialize with forest ambience
        playTrack('forest');
    </script>
</body>
</html> 
